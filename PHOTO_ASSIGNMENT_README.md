# نظام ربط الصور الشخصية تلقائياً للموظفين

## نظرة عامة
هذا النظام يربط الصور الشخصية من مجلد `D:\ett\old` بالموظفين في قاعدة البيانات تلقائياً بناءً على أسمائهم.

## الملفات المتاحة

### 1. `assign_profile_pictures.php` - السكريبت الرئيسي
- **الوصف**: سكريبت ذكي يربط الصور بالموظفين باستخدام خوارزمية مطابقة الأسماء
- **الميزات**:
  - مقارنة ذكية للأسماء العربية والإنجليزية
  - تحويل الأسماء الإنجليزية إلى عربية
  - حساب نقاط التطابق لأفضل نتيجة
  - نسخ الصور إلى مجلد التخزين المناسب
  - تحديث قاعدة البيانات تلقائياً

### 2. `quick_assign_photos.php` - السكريبت السريع
- **الوصف**: سكريبت مبسط يستخدم خريطة مباشرة للأسماء
- **الميزات**:
  - ربط مباشر للأسماء المعروفة
  - أسرع في التنفيذ
  - مناسب للاستخدام السريع

### 3. `check_photo_assignments.php` - سكريبت الفحص
- **الوصف**: يتحقق من حالة ربط الصور ويعرض تقارير مفصلة
- **الميزات**:
  - إحصائيات شاملة
  - فحص الصور المفقودة
  - تقارير حسب القسم
  - معلومات عن حجم الصور

## كيفية الاستخدام

### الخطوة 1: التأكد من وجود الصور
```bash
# تحقق من وجود مجلد الصور
ls "D:\ett\old"
```

### الخطوة 2: تشغيل السكريبت الرئيسي
```bash
php assign_profile_pictures.php
```

### الخطوة 3: تشغيل السكريبت السريع (اختياري)
```bash
php quick_assign_photos.php
```

### الخطوة 4: فحص النتائج
```bash
php check_photo_assignments.php
```

## خوارزمية المطابقة

### 1. تنظيف الأسماء
- إزالة الأرقام والرموز الخاصة
- إزالة الامتدادات
- تقليل المسافات الزائدة

### 2. تحويل الأسماء
- تحويل الأسماء الإنجليزية إلى عربية
- دعم أكثر من 50 اسم شائع

### 3. مقارنة الأسماء
- مقارنة مباشرة
- مقارنة كلمات منفصلة
- حساب نقاط التطابق

### 4. اختيار أفضل تطابق
- نقاط عالية للتطابق الكامل
- نقاط متوسطة للتطابق الجزئي
- نقاط منخفضة للتطابق الضعيف

## الأسماء المدعومة

### أسماء ذكور
- أحمد، محمد، محمود، علي، حسن، حسين
- سعيد، عمر، يوسف، كريم، عمرو، ياسر
- أشرف، عماد، صلاح، طارق، جمال، علاء
- هاني، وائل، نادر، مصطفى، خالد، إبراهيم
- أسامة، وليد، سامح، رامي، عادل، فاروق

### أسماء إناث
- حنان، هبة، نور، مي، آية، سلمى
- راضية، مريم، سارة، إيمان، هند، روان
- ياسمين، أميرة، علياء، هاجر، تسنيم
- شيماء، جوستينا، وفاء، رانيا، نوران، رحام

## مجلدات التخزين

### الصور المصدر
```
D:\ett\old\
├── ahmed-mahmoud.png
├── hanan.png
├── emad-saad.png
└── ...
```

### الصور المنسوخة
```
storage/app/public/profile_pictures/
├── 1640995200_ahmed-mahmoud.png
├── 1640995201_hanan.png
└── ...
```

## قاعدة البيانات

### جدول المستخدمين
```sql
users
├── id
├── name (الاسم الإنجليزي)
├── name_ar (الاسم العربي)
├── profile_picture (مسار الصورة)
└── ...
```

## نصائح للاستخدام

### 1. قبل التشغيل
- تأكد من وجود نسخة احتياطية من قاعدة البيانات
- تحقق من صلاحيات الكتابة في مجلد التخزين
- تأكد من وجود جميع الصور في المجلد المحدد

### 2. أثناء التشغيل
- راقب الرسائل للتأكد من التقدم
- توقف إذا ظهرت أخطاء خطيرة
- احتفظ بسجل من النتائج

### 3. بعد التشغيل
- شغل سكريبت الفحص للتأكد من النتائج
- تحقق من الصور في الواجهة الأمامية
- أضف الصور المفقودة يدوياً إذا لزم الأمر

## حل المشاكل الشائعة

### مشكلة: الصور لا تظهر
**الحل**: تحقق من:
- وجود الصور في مجلد `storage/app/public/profile_pictures/`
- صحة مسارات الصور في قاعدة البيانات
- صلاحيات المجلدات

### مشكلة: تطابق خاطئ للأسماء
**الحل**: 
- راجع خريطة الأسماء في السكريبت السريع
- أضف استثناءات جديدة
- استخدم السكريبت الرئيسي بدلاً من السريع

### مشكلة: أخطاء في النسخ
**الحل**:
- تحقق من صلاحيات الكتابة
- تأكد من وجود مساحة كافية
- تحقق من صحة مسارات الملفات

## التطوير المستقبلي

### ميزات مقترحة
1. واجهة ويب لإدارة الصور
2. دعم المزيد من صيغ الصور
3. ضغط الصور تلقائياً
4. دعم الصور من مصادر متعددة
5. نظام النسخ الاحتياطي للصور

### تحسينات مقترحة
1. تحسين خوارزمية المطابقة
2. دعم الأسماء المركبة
3. إضافة معاينة الصور
4. نظام التصويت للأفضل تطابق

## الدعم الفني

في حالة وجود مشاكل:
1. راجع ملفات السجل
2. تحقق من رسائل الخطأ
3. استخدم سكريبت الفحص للتشخيص
4. تواصل مع فريق التطوير

---

**ملاحظة**: تأكد من عمل نسخة احتياطية من قاعدة البيانات قبل تشغيل أي سكريبت.
