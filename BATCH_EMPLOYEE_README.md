# ميزة إضافة الموظفين بالدفعة

## نظرة عامة
تم إضافة ميزة جديدة تسمح بإضافة الموظفين بالدفعة من خلال رفع ملف Excel. هذه الميزة مفيدة لإضافة عدد كبير من الموظفين في وقت واحد.

## الملفات المضافة/المحدثة

### 1. Controller جديد
- `app/Http/Controllers/BatchEmployeeController.php` - Controller مخصص لإدارة إضافة الموظفين بالدفعة

### 2. View جديد
- `resources/views/users/batch-create.blade.php` - صفحة إضافة الموظفين بالدفعة

### 3. Routes محدثة
- `routes/web.php` - إضافة طرق جديدة:
  - `GET /batch/create` - عرض صفحة إضافة الموظفين بالدفعة
  - `POST /batch/store` - معالجة رفع الملف وإنشاء الموظفين
  - `GET /batch/template` - تحميل قالب Excel

### 4. Views محدثة
- `resources/views/users/index.blade.php` - إضافة زر "إضافة الموظفين بالدفعة"

### 5. الترجمة
- `lang/ar/messages.php` - إضافة نصوص الترجمة الجديدة

### 6. Dependencies
- `composer.json` - إضافة مكتبة PhpSpreadsheet

## كيفية الاستخدام

### 1. الوصول للميزة
- اذهب إلى صفحة "إدارة المستخدمين"
- اضغط على زر "إضافة الموظفين بالدفعة" (الزر الأخضر)

### 2. تحميل قالب Excel
- اضغط على "تحميل قالب Excel" لتحميل ملف قالب يحتوي على الأعمدة المطلوبة
- املأ البيانات في الملف

### 3. رفع الملف
- اختر ملف Excel المملوء بالبيانات
- اختر القسم والمنصب الافتراضي للموظفين الجدد
- قم بربط الأعمدة في الملف مع الحقول في النظام
- اضغط على "إضافة الموظفين"

## الحقول المدعومة

### الحقول المطلوبة
- **الاسم** (Name) - مطلوب
- **البريد الإلكتروني** (Email) - مطلوب

### الحقول الاختيارية
- الاسم بالعربي (Name Arabic)
- هاتف العمل (Phone Work)
- الهاتف الشخصي (Phone Personal)
- البريد الإلكتروني للعمل (Work Email)
- المسمى الوظيفي (Job Title)
- المنصب (Position)
- المنصب بالعربي (Position Arabic)
- العنوان (Address)
- العنوان بالعربي (Address Arabic)
- تاريخ الميلاد (Birthday)
- نبذة شخصية (Bio)
- ملاحظات (Notes)
- رابط LinkedIn (LinkedIn URL)
- رابط الموقع (Website URL)
- رقم AVAYA الداخلي (AVAYA Extension)
- معرف Microsoft Teams (Microsoft Teams ID)
- عنوان المكتب (Office Address)

## الميزات

### 1. واجهة سهلة الاستخدام
- تصميم responsive يعمل على جميع الأجهزة
- تعليمات واضحة للمستخدم
- معاينة البيانات قبل الرفع

### 2. ربط الأعمدة المرن
- يمكن ربط أي عمود في ملف Excel مع أي حقل في النظام
- دعم للحقول المطلوبة والاختيارية
- التحقق من صحة البيانات

### 3. معالجة الأخطاء
- رسائل خطأ واضحة
- تخطي الصفوف التي تحتوي على أخطاء
- تقرير مفصل عن النتائج

### 4. قالب Excel
- قالب جاهز يحتوي على جميع الحقول المدعومة
- بيانات نموذجية للمساعدة في الفهم
- تنسيق احترافي

## المتطلبات التقنية

### 1. مكتبة PhpSpreadsheet
```bash
composer require phpoffice/phpspreadsheet
```

### 2. صلاحيات المستخدم
- يجب أن يكون للمستخدم صلاحية `users.create`

### 3. متطلبات الملف
- صيغة الملف: .xlsx أو .xls
- الحد الأقصى للحجم: 10 ميجابايت
- يجب أن يحتوي على صف رؤوس

## الأمان

### 1. التحقق من الصلاحيات
- جميع الطرق محمية بـ middleware `permission:users.create`

### 2. التحقق من صحة البيانات
- التحقق من صيغة الملف
- التحقق من الحقول المطلوبة
- التحقق من صحة البريد الإلكتروني

### 3. معالجة الأخطاء
- معالجة آمنة للأخطاء
- عدم كشف معلومات حساسة في رسائل الخطأ

## التطوير المستقبلي

### 1. ميزات مقترحة
- دعم لصيغ ملفات أخرى (CSV)
- إمكانية تحديث الموظفين الموجودين
- تصدير تقرير مفصل عن النتائج
- دعم للصور الشخصية

### 2. تحسينات الأداء
- معالجة الملفات الكبيرة
- معالجة متوازية للبيانات
- تحسين استهلاك الذاكرة

## استكشاف الأخطاء

### 1. مشاكل شائعة
- **خطأ في قراءة الملف**: تأكد من صيغة الملف (.xlsx أو .xls)
- **حقول مطلوبة مفقودة**: تأكد من ربط الحقول المطلوبة (الاسم والبريد الإلكتروني)
- **خطأ في الصلاحيات**: تأكد من أن المستخدم لديه صلاحية إضافة المستخدمين

### 2. سجلات الأخطاء
- تحقق من ملف `storage/logs/laravel.log` للأخطاء المفصلة
- استخدم `php artisan log:clear` لمسح السجلات القديمة

## الدعم

للمساعدة أو الإبلاغ عن مشاكل، يرجى التواصل مع فريق التطوير.
