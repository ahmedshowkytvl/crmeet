<?php

use Illuminate\Support\Facades\DB;
use App\Models\User;

// سكريبت تعيين المديرين للموظفين
function assignManagersToEmployees() {
    echo "بدء تعيين المديرين للموظفين...\n";

    // mapping للمديرين
    $managerMapping = [
        '981' => '??? ?????? ???? ??? ??????',
        '726' => '???? ????? ???? ?????',
        '59' => '??? ???? ??? ???',
        '16' => '???? ???? ???? ?????',
        '1021' => '???? ???????',
        '1023' => '???? ???? ??? ??????',
        '156' => '???? ???? ????',
        '35' => '???? ???? ???? ?????',
        '11' => '???? ???? ???? ??????',
        '2' => '???? ?????? ???????? ?????????',
        '338' => '???? ???? ??? ?????',
    ];

    // mapping للعلاقات بين المديرين والموظفين
    $reportingRelations = [
        '156' => '726', // ???? ???? ???? -> HR
        '3' => '726', // ????? ??? ?????? ????? ??? ?????? ????? -> HR
        '1019' => '726', // ???? ????? ??? -> HR
        '1022' => '726', // ????? ???? ??? -> HR
    ];

    // تعيين المديرين
    foreach ($reportingRelations as $employeeCode => $managerCode) {
        $employee = User::where('EmployeeCode', $employeeCode)->first();
        $manager = User::where('EmployeeCode', $managerCode)->first();
        
        if ($employee && $manager) {
            $employee->update(['manager_id' => $manager->id]);
            echo "تم تعيين المدير {$manager->name} للموظف {$employee->name}\n";
        } else {
            echo "لم يتم العثور على الموظف {$employeeCode} أو المدير {$managerCode}\n";
        }
    }
    
    echo "تم الانتهاء من تعيين المديرين!\n";
}

// تشغيل السكريبت
assignManagersToEmployees();
